window.AstronomyAPI=class{getPlaceholder(e){const t=document.createElement("p");return t.style.fontSize="10px",t.style.color="#444",t.style.textAlign="center",t.style.verticalAlign="middle",t.innerText=e,t}setContainerSize(e,t,s){"moon-phase"==e&&(t.style.width="portrait-simple"==s?"200px":"260px",t.style.height="portrait-simple"==s?"260px":"160px"),"star-chart"==e&&(t.style.width="800px",t.style.height="617px")}request(e,t,s,r){const o=new XMLHttpRequest,a=this;o.onreadystatechange=function(){if(4==this.readyState)if(200==this.status){const e=JSON.parse(this.responseText);if(r){const t=new Image;t.src=e.data.imageUrl,r.replaceChildren(t)}s&&s(e)}else 422==this.status?(console.error(JSON.parse(this.responseText)),r.replaceChildren(a.getPlaceholder("Error"))):(console.error("unknown error"),r.replaceChildren(a.getPlaceholder("Error")))},o.open("POST",`${this.apiBaseUrl}/${e}`,!0),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Authorization",`Basic ${this.params.basicToken}`),o.send(JSON.stringify(t))}constructor(e){if(this.apiBaseUrl="https://api.astronomyapi.com",this.moonPhase=(e,t)=>{e=Object.assign({element:"#moon-phase",format:"png",style:{moonStyle:"default",backgroundStyle:"stars",backgroundColor:"black",headingColor:"white",textColor:"white"},observer:{latitude:0,longitude:0,date:(new Date).toISOString()},view:{type:"portrait-simple"}},e);const s=document.querySelector(e.element);this.setContainerSize("moon-phase",s,e.view.type),s.append(this.getPlaceholder("Loading...")),this.request("api/v2/studio/moon-phase",e,t,s)},this.starChart=(e,t)=>{e=Object.assign({element:"#star-chart",style:"default",observer:{latitude:0,longitude:0,date:(new Date).toISOString()},view:{type:"area",parameters:{position:{equatorial:{rightAscension:12.83,declination:-15.23}},zoom:3}}},e);const s=document.querySelector(e.element);this.setContainerSize("star-chart",s,e.view.type),s.append(this.getPlaceholder("Loading...")),this.request("api/v2/studio/star-chart",e,t,s)},this.params=e,!e.basicToken||e.basicToken.length<10)throw new Error("`basicToken` must be set during construction")}};